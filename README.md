# CMU Delphi Covid-19 Forecasts

Public repository for [CMU Delphi](https://delphi.cmu.edu) forecasting efforts for SARS-Cov2

## Table of Contents

* [Delphi Forecasting Efforts](#delphi-forecasting-efforts)
* [Usage](#usage)
* [Organization](#organization)
* [Contributers](#contributers)

## Organization

* **forecasters:** R packaged versions of forecasters; follow README here for instructions on how to prepare your forecaster.

* **utilities:** packages used for production runs, evaluation, and other pipeline utilities for the forecasters

* **data**: cached upstream data, data generated by training runs

* **docs**: documentation for forecasters, utility packages

* **logs**: training run logs

## Contributers

- Alden Green (Carnegie Mellon University)
- Addison Hu (Carnegie Mellon University)
- Maria Jahja (Carnegie Mellon University)
- Valerie Ventura (Carnegie Mellon University)
- Larry Wasserman (Carnegie Mellon University)
- Rob Tibshirani (Stanford University)
- Vishnu Shankar (Stanford University)
- Jacob Bien (University of Southern California)
- Logan Brooks (Carnegie Mellon University)
- Balasubramanian Narasimhan (Stanford University)
- Samyak Rajanala (Stanford University)
- Aaron Rumack (Carnegie Mellon University)
- Noah Simon (University of Washington)
- James Sharpnack (UC Davis)
- Daniel McDonald (University of British Columbia)
- Ryan Tibshirani (Carnegie Mellon University)
and the Delphi COVID-19 Response Team


# gh-actions

When adding a new forecaster or other package, take the following steps BEFORE you issue a pull request.
1. On main/.github, copy one of the existing actions.
2. Modify it to apply to your new package. And rename it following the conventions.
3. Switch to develop and merge main onto develop to get your new Action there.
4. Now switch to your package branch, issue a pull request to develop, and tag @dajmcdon or @jsharpna as reviewers.

If the check fails, revisit your package. Run R CMD Check locally and fix the problems. Make sure any dependencies are included as necessary. See the DESCRIPTION for `{aardvark}` as an example. If that all fails, get help on Slack.

# Current forecasting structure

* All forecasts are run off a script in the `/utilities` folder. There is a more "operations" oriented description of the pipeline there.

Our main "production" forecaster lives in the `animalia` package under `/utilities`. The goal is for this single
forecasting framework to be sufficiently generalizable that any forecaster we wish to implement can take
advantage of its flexibility. That said, it shouldn't be so complicated that it's challenging to maintain.
More details can be found in the documentation for that package. As of 4/20/21, we produce county case and state
death forecasts using this package, respectively named `zebra` and `anteater`.

The production forecaster uses [`covidcast/modeltools`](https://cmu-delphi.github.io/covidcast/modeltoolsR/index.html)
to implement some preprocessing steps, but the core
estimation method uses [`ryantibs/quantgen`](https://ryantibs.github.io/quantgen/index.html) 
to produce the full set of quantile forecasts. It's structure
is based on `modeltools/quantile_forecaster()` and the related 
[vignette](https://cmu-delphi.github.io/covidcast/modeltoolsR/articles/quantgen-forecast.html) provides background. The 
version here allows for more general handling of cross validation and "featurization" in order to do the
necessary preprocessing required in production. The featurization steps are the main difference between the two 
porduction forecasters. These functions also reside within `animalia`.
